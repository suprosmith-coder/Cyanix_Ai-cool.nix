<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyanix AI - ChatGPT Alternative</title>
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0d0221">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Cyanix AI">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <meta name="description" content="Cyanix AI - Advanced ChatGPT-like AI assistant with secure authentication">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --cyan-primary: #00f3ff;
            --cyan-secondary: #00a8b5;
            --cyan-light: #6bffff;
            --purple-dark: #0d0221;
            --purple-deep: #1a0633;
            --gray-dark: #1e1e2e;
            --gray-medium: #2d2d3a;
            --gray-light: #f5f5f7;
            --white: #ffffff;
            --neon-glow: 0 0 10px var(--cyan-primary), 0 0 20px var(--cyan-primary), 0 0 30px var(--cyan-primary);
            --card-shadow: 0 8px 32px rgba(0, 243, 255, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--purple-dark);
            color: var(--white);
            height: 100vh;
            overflow: hidden;
            position: fixed;
            width: 100%;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Splash Screen */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--purple-dark);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            animation: fadeOut 0.5s ease-out 2s forwards;
        }

        .splash-logo {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--cyan-secondary), var(--cyan-primary));
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            box-shadow: var(--neon-glow);
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }

        .splash-title {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--cyan-primary), var(--cyan-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .splash-subtitle {
            font-size: 16px;
            color: var(--cyan-light);
            opacity: 0.8;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes fadeOut {
            to { opacity: 0; visibility: hidden; }
        }

        /* Auth Container */
        .auth-container {
            display: flex;
            min-height: 100vh;
        }

        .auth-left {
            flex: 1;
            background: linear-gradient(135deg, var(--purple-dark), var(--purple-deep));
            padding: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .auth-left::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(0, 243, 255, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(157, 78, 221, 0.1) 0%, transparent 50%);
        }

        .auth-right {
            flex: 1;
            background: var(--gray-dark);
            padding: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .auth-logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 40px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--cyan-secondary), var(--cyan-primary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--neon-glow);
        }

        .logo-text {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--cyan-primary), var(--cyan-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .auth-title {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 15px;
            line-height: 1.2;
        }

        .auth-subtitle {
            font-size: 18px;
            color: var(--cyan-light);
            opacity: 0.8;
            margin-bottom: 40px;
        }

        .features-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 40px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--cyan-light);
            font-size: 14px;
        }

        .feature-icon {
            color: var(--cyan-primary);
            font-size: 20px;
        }

        /* Auth Forms */
        .auth-form {
            max-width: 400px;
            margin: 0 auto;
            width: 100%;
        }

        .auth-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 40px;
            background: var(--gray-medium);
            padding: 6px;
            border-radius: 12px;
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: transparent;
            border: none;
            color: var(--white);
            font-size: 16px;
            font-weight: 500;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .auth-tab.active {
            background: var(--cyan-primary);
            color: var(--purple-dark);
            box-shadow: var(--neon-glow);
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--cyan-light);
        }

        .form-input {
            width: 100%;
            padding: 16px;
            background: var(--gray-medium);
            border: 2px solid transparent;
            border-radius: 12px;
            font-size: 16px;
            color: var(--white);
            transition: var(--transition);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--cyan-primary);
            box-shadow: 0 0 0 3px rgba(0, 243, 255, 0.1);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .password-toggle {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--cyan-light);
            cursor: pointer;
        }

        .password-wrapper {
            position: relative;
        }

        .form-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--cyan-light);
        }

        .checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid var(--cyan-primary);
            border-radius: 4px;
            cursor: pointer;
        }

        .forgot-password {
            color: var(--cyan-primary);
            text-decoration: none;
            font-size: 14px;
            transition: var(--transition);
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        .auth-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--cyan-secondary), var(--cyan-primary));
            color: var(--purple-dark);
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 30px;
            box-shadow: var(--neon-glow);
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.4);
        }

        .auth-btn:active {
            transform: translateY(0);
        }

        .auth-divider {
            display: flex;
            align-items: center;
            margin: 30px 0;
            color: var(--cyan-light);
            font-size: 14px;
        }

        .auth-divider::before,
        .auth-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--gray-medium);
        }

        .auth-divider span {
            padding: 0 20px;
        }

        .social-auth {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 30px;
        }

        .social-btn {
            padding: 16px;
            background: var(--gray-medium);
            border: 2px solid transparent;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 18px;
            color: var(--white);
        }

        .social-btn:hover {
            border-color: var(--cyan-primary);
            transform: translateY(-2px);
        }

        .google-btn {
            color: #4285F4;
        }

        .microsoft-btn {
            color: #00A4EF;
        }

        .email-btn {
            color: var(--cyan-primary);
        }

        .auth-footer {
            text-align: center;
            color: var(--cyan-light);
            font-size: 14px;
        }

        .auth-footer a {
            color: var(--cyan-primary);
            text-decoration: none;
            font-weight: 500;
        }

        .auth-footer a:hover {
            text-decoration: underline;
        }

        /* Email Verification Container */
        .verification-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--purple-dark);
            z-index: 10001;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .verification-container.active {
            display: flex;
        }

        .verification-card {
            background: var(--gray-dark);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: var(--card-shadow);
            border: 2px solid var(--cyan-primary);
            text-align: center;
        }

        .verification-icon {
            font-size: 64px;
            color: var(--cyan-primary);
            margin-bottom: 20px;
        }

        .verification-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--white);
        }

        .verification-subtitle {
            color: var(--cyan-light);
            margin-bottom: 30px;
            font-size: 16px;
            opacity: 0.8;
        }

        .verification-email {
            color: var(--cyan-primary);
            font-weight: 600;
            background: rgba(0, 243, 255, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            margin: 10px 0;
        }

        .verification-code-input {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
        }

        .code-input {
            width: 50px;
            height: 60px;
            text-align: center;
            font-size: 24px;
            font-weight: 600;
            background: var(--gray-medium);
            border: 2px solid transparent;
            border-radius: 10px;
            color: var(--white);
            transition: var(--transition);
        }

        .code-input:focus {
            outline: none;
            border-color: var(--cyan-primary);
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }

        .verification-timer {
            color: var(--cyan-light);
            margin: 20px 0;
            font-size: 14px;
        }

        .verification-timer span {
            color: var(--cyan-primary);
            font-weight: 600;
        }

        .verification-resend {
            color: var(--cyan-primary);
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            transition: var(--transition);
        }

        .verification-resend:hover {
            text-decoration: underline;
        }

        .verification-resend.disabled {
            color: var(--gray-medium);
            cursor: not-allowed;
        }

        /* Terms Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal {
            background: var(--gray-dark);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--card-shadow);
            border: 2px solid var(--cyan-primary);
        }

        .modal-header {
            margin-bottom: 30px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 10px;
        }

        .modal-subtitle {
            color: var(--cyan-light);
            font-size: 14px;
            opacity: 0.8;
        }

        .modal-content {
            color: var(--cyan-light);
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .modal-content p {
            margin-bottom: 15px;
        }

        .modal-footer {
            display: flex;
            gap: 12px;
        }

        .modal-btn {
            flex: 1;
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-btn.primary {
            background: var(--cyan-primary);
            color: var(--purple-dark);
            border: none;
        }

        .modal-btn.secondary {
            background: transparent;
            color: var(--cyan-light);
            border: 2px solid var(--gray-medium);
        }

        /* Error Messages */
        .error-message {
            color: #ff4757;
            font-size: 12px;
            margin-top: 4px;
            display: none;
        }

        .error-message.show {
            display: block;
            animation: shake 0.3s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .auth-container {
                flex-direction: column;
            }

            .auth-left,
            .auth-right {
                padding: 40px 20px;
            }

            .features-list {
                grid-template-columns: 1fr;
            }

            .verification-code-input {
                gap: 5px;
            }

            .code-input {
                width: 40px;
                height: 50px;
                font-size: 20px;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-logo">
            <i class="fas fa-robot"></i>
        </div>
        <h1 class="splash-title">Cyanix AI</h1>
        <p class="splash-subtitle">Loading your AI assistant...</p>
    </div>

    <!-- Email Verification Container -->
    <div id="verificationContainer" class="verification-container">
        <div class="verification-card">
            <div class="verification-icon">
                <i class="fas fa-envelope"></i>
            </div>
            <h2 class="verification-title">Verify Your Email</h2>
            <p class="verification-subtitle">
                We've sent a 6-digit verification code to your email address.
                Please enter it below to complete your registration.
            </p>
            <div class="verification-email" id="verificationEmail"></div>
            
            <div class="verification-code-input" id="codeInputs">
                <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 1)" onkeyup="handleCodeKeyUp(event, 1)" onfocus="this.select()">
                <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 2)" onkeyup="handleCodeKeyUp(event, 2)" onfocus="this.select()">
                <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 3)" onkeyup="handleCodeKeyUp(event, 3)" onfocus="this.select()">
                <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 4)" onkeyup="handleCodeKeyUp(event, 4)" onfocus="this.select()">
                <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 5)" onkeyup="handleCodeKeyUp(event, 5)" onfocus="this.select()">
                <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 6)" onkeyup="handleCodeKeyUp(event, 6)" onfocus="this.select()">
            </div>
            
            <div class="verification-timer">
                Code expires in: <span id="timer">05:00</span>
            </div>
            
            <a href="#" class="verification-resend" onclick="resendVerificationCode()" id="resendLink">
                Didn't receive the code? Resend
            </a>
            
            <div style="margin-top: 30px; display: flex; gap: 10px;">
                <button class="modal-btn secondary" onclick="goBackToSignup()">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <button class="modal-btn primary" onclick="verifyEmailCode()">
                    <i class="fas fa-check"></i> Verify
                </button>
            </div>
        </div>
    </div>

    <!-- Auth Container -->
    <div id="authContainer" class="auth-container">
        <div class="auth-left">
            <div class="auth-logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="logo-text">Cyanix AI</div>
            </div>
            
            <h1 class="auth-title">Welcome to the Future of AI Conversation</h1>
            <p class="auth-subtitle">Experience ChatGPT-level intelligence with enhanced privacy and control</p>
            
            <div class="features-list">
                <div class="feature-item">
                    <i class="fas fa-bolt feature-icon"></i>
                    <span>Instant Responses</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-shield-alt feature-icon"></i>
                    <span>End-to-End Encryption</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-history feature-icon"></i>
                    <span>Unlimited Conversation History</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-mobile-alt feature-icon"></i>
                    <span>Cross-Platform Sync</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-code feature-icon"></i>
                    <span>Code Execution Support</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-file-export feature-icon"></i>
                    <span>Export Conversations</span>
                </div>
            </div>
        </div>
        
        <div class="auth-right">
            <div class="auth-form" id="authForm">
                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('signin')">Sign In</button>
                    <button class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</button>
                </div>
                
                <!-- Sign In Form -->
                <div id="signinForm" class="auth-form-content">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="signinEmail" class="form-input" placeholder="Enter your email" required>
                        <div class="error-message" id="signinEmailError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <div class="password-wrapper">
                            <input type="password" id="signinPassword" class="form-input" placeholder="Enter your password" required>
                            <button class="password-toggle" type="button" onclick="togglePassword('signinPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="error-message" id="signinPasswordError"></div>
                    </div>
                    
                    <div class="form-options">
                        <label class="remember-me">
                            <input type="checkbox" id="rememberMe" class="checkbox">
                            <span>Remember me</span>
                        </label>
                        <a href="#" class="forgot-password" onclick="showForgotPassword()">Forgot Password?</a>
                    </div>
                    
                    <button class="auth-btn" id="signinBtn" onclick="signInWithEmail()">Sign In</button>
                    
                    <div class="auth-divider">
                        <span>Or continue with</span>
                    </div>
                    
                    <div class="social-auth">
                        <button class="social-btn google-btn" onclick="signInWithGoogle()">
                            <i class="fab fa-google"></i>
                        </button>
                        <button class="social-btn microsoft-btn" onclick="signInWithMicrosoft()">
                            <i class="fab fa-microsoft"></i>
                        </button>
                        <button class="social-btn email-btn" onclick="signInWithEmail()">
                            <i class="fas fa-envelope"></i>
                        </button>
                    </div>
                    
                    <p class="auth-footer">
                        Don't have an account? <a href="#" onclick="switchAuthTab('signup')">Sign Up</a>
                    </p>
                </div>
                
                <!-- Sign Up Form -->
                <div id="signupForm" class="auth-form-content" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" id="signupName" class="form-input" placeholder="Enter your full name" required>
                        <div class="error-message" id="signupNameError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="signupEmail" class="form-input" placeholder="Enter your email" required>
                        <div class="error-message" id="signupEmailError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <div class="password-wrapper">
                            <input type="password" id="signupPassword" class="form-input" placeholder="Create a password (min. 8 characters)" required>
                            <button class="password-toggle" type="button" onclick="togglePassword('signupPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="error-message" id="signupPasswordError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <div class="password-wrapper">
                            <input type="password" id="signupConfirmPassword" class="form-input" placeholder="Confirm your password" required>
                            <button class="password-toggle" type="button" onclick="togglePassword('signupConfirmPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="error-message" id="signupConfirmPasswordError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="remember-me">
                            <input type="checkbox" id="acceptTerms" class="checkbox">
                            <span>I agree to the <a href="#" class="forgot-password" onclick="showTermsModal()">Terms & Privacy</a></span>
                        </label>
                        <div class="error-message" id="acceptTermsError"></div>
                    </div>
                    
                    <button class="auth-btn" id="signupBtn" onclick="signUpWithEmail()">Create Account</button>
                    
                    <div class="auth-divider">
                        <span>Or sign up with</span>
                    </div>
                    
                    <div class="social-auth">
                        <button class="social-btn google-btn" onclick="signUpWithGoogle()">
                            <i class="fab fa-google"></i>
                        </button>
                        <button class="social-btn microsoft-btn" onclick="signUpWithMicrosoft()">
                            <i class="fab fa-microsoft"></i>
                        </button>
                        <button class="social-btn email-btn" onclick="signUpWithEmail()">
                            <i class="fas fa-envelope"></i>
                        </button>
                    </div>
                    
                    <p class="auth-footer">
                        Already have an account? <a href="#" onclick="switchAuthTab('signin')">Sign In</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Terms & Privacy Modal -->
    <div id="termsModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Terms & Privacy Policy</h2>
                <p class="modal-subtitle">Last updated: January 2024</p>
            </div>
            <div class="modal-content">
                <p>By using Cyanix AI, you agree to our terms and privacy policy.</p>
                <p><strong>Data Privacy:</strong> We encrypt all your conversations end-to-end. Your data never leaves your device unless you explicitly choose to sync across devices.</p>
                <p><strong>Usage Policy:</strong> You agree to use Cyanix AI responsibly and not for any illegal activities, harassment, or generating harmful content.</p>
                <p><strong>Intellectual Property:</strong> You retain all rights to the content you create with Cyanix AI. We claim no ownership over your generated content.</p>
                <p><strong>Service Availability:</strong> We strive for 99.9% uptime but cannot guarantee uninterrupted service.</p>
                <p><strong>Changes to Terms:</strong> We may update these terms periodically. Continued use after changes constitutes acceptance.</p>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="hideTermsModal()">Cancel</button>
                <button class="modal-btn primary" onclick="acceptTerms()">I Accept</button>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgotPasswordModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Reset Password</h2>
                <p class="modal-subtitle">Enter your email to receive reset instructions</p>
            </div>
            <div class="modal-content">
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" id="resetEmail" class="form-input" placeholder="Enter your email">
                    <div class="error-message" id="resetEmailError"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="hideForgotPassword()">Cancel</button>
                <button class="modal-btn primary" onclick="sendResetEmail()">Send Reset Link</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== APP STATE ====================
        let currentUser = null;
        let verificationCode = null;
        let verificationTimer = null;
        let pendingUser = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            initApp();
        });

        function initApp() {
            // Hide splash screen after delay
            setTimeout(() => {
                document.getElementById('splashScreen').style.display = 'none';
                
                // Check if user is already logged in
                const savedUser = localStorage.getItem('cyanix_user');
                if (savedUser) {
                    try {
                        currentUser = JSON.parse(savedUser);
                        showChatInterface();
                    } catch (e) {
                        console.error('Error parsing saved user:', e);
                        localStorage.removeItem('cyanix_user');
                    }
                }
            }, 2000);
            
            // Initialize form event listeners
            initializeAuthForms();
        }

        // ==================== FORM UTILITIES ====================
        function initializeAuthForms() {
            // Add enter key support for forms
            const signinEmail = document.getElementById('signinEmail');
            const signinPassword = document.getElementById('signinPassword');
            const signupName = document.getElementById('signupName');
            const signupEmail = document.getElementById('signupEmail');
            const signupPassword = document.getElementById('signupPassword');
            const signupConfirmPassword = document.getElementById('signupConfirmPassword');
            
            if (signinEmail) {
                signinEmail.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') signInWithEmail();
                });
            }
            
            if (signinPassword) {
                signinPassword.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') signInWithEmail();
                });
            }
            
            if (signupEmail) {
                signupEmail.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') signUpWithEmail();
                });
            }
            
            if (signupPassword) {
                signupPassword.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') signUpWithEmail();
                });
            }
            
            if (signupConfirmPassword) {
                signupConfirmPassword.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') signUpWithEmail();
                });
            }
            
            // Clear errors on input
            document.querySelectorAll('.form-input').forEach(input => {
                input.addEventListener('input', () => {
                    const errorId = input.id + 'Error';
                    const errorElement = document.getElementById(errorId);
                    if (errorElement) {
                        errorElement.classList.remove('show');
                    }
                });
            });
        }

        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            if (errorElement) {
                errorElement.textContent = message;
                errorElement.classList.add('show');
            }
        }

        function clearErrors() {
            document.querySelectorAll('.error-message').forEach(el => {
                el.classList.remove('show');
            });
        }

        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const toggle = input.nextElementSibling.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                toggle.classList.remove('fa-eye');
                toggle.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                toggle.classList.remove('fa-eye-slash');
                toggle.classList.add('fa-eye');
            }
        }

        // ==================== AUTHENTICATION ====================
        function switchAuthTab(tab) {
            const signinTab = document.querySelector('[onclick="switchAuthTab(\'signin\')"]');
            const signupTab = document.querySelector('[onclick="switchAuthTab(\'signup\')"]');
            const signinForm = document.getElementById('signinForm');
            const signupForm = document.getElementById('signupForm');
            
            clearErrors();
            
            if (tab === 'signin') {
                signinTab.classList.add('active');
                signupTab.classList.remove('active');
                signinForm.style.display = 'block';
                signupForm.style.display = 'none';
            } else {
                signinTab.classList.remove('active');
                signupTab.classList.add('active');
                signinForm.style.display = 'none';
                signupForm.style.display = 'block';
            }
        }

        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function showToast(message, type = 'info') {
            // Remove existing toasts
            const existingToasts = document.querySelectorAll('.custom-toast');
            existingToasts.forEach(toast => toast.remove());
            
            const toast = document.createElement('div');
            toast.className = `custom-toast ${type}`;
            toast.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? '#ff4757' : type === 'success' ? '#2ed573' : '#3742fa'};
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                animation: slideIn 0.3s ease;
                max-width: 400px;
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Add CSS for toast animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ==================== SIGN UP FUNCTION ====================
        function signUpWithEmail() {
            console.log('Sign up button clicked'); // Debug log
            
            // Get form values
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const acceptTerms = document.getElementById('acceptTerms').checked;
            
            // Clear previous errors
            clearErrors();
            
            // Validation
            let isValid = true;
            
            if (!name) {
                showError('signupNameError', 'Please enter your full name');
                isValid = false;
            }
            
            if (!email) {
                showError('signupEmailError', 'Please enter your email address');
                isValid = false;
            } else if (!validateEmail(email)) {
                showError('signupEmailError', 'Please enter a valid email address');
                isValid = false;
            }
            
            if (!password) {
                showError('signupPasswordError', 'Please create a password');
                isValid = false;
            } else if (password.length < 8) {
                showError('signupPasswordError', 'Password must be at least 8 characters');
                isValid = false;
            }
            
            if (!confirmPassword) {
                showError('signupConfirmPasswordError', 'Please confirm your password');
                isValid = false;
            } else if (password !== confirmPassword) {
                showError('signupConfirmPasswordError', 'Passwords do not match');
                isValid = false;
            }
            
            if (!acceptTerms) {
                showError('acceptTermsError', 'You must accept the terms and privacy policy');
                isValid = false;
            }
            
            if (!isValid) {
                showToast('Please fix the errors in the form', 'error');
                return;
            }
            
            // Check if user already exists in localStorage
            const existingUsers = JSON.parse(localStorage.getItem('cyanix_users') || '[]');
            if (existingUsers.some(u => u.email === email)) {
                showError('signupEmailError', 'An account with this email already exists');
                showToast('An account with this email already exists. Please sign in instead.', 'error');
                return;
            }
            
            // Disable signup button and show loading
            const signupBtn = document.getElementById('signupBtn');
            const originalText = signupBtn.innerHTML;
            signupBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';
            signupBtn.disabled = true;
            
            // Simulate API call delay
            setTimeout(() => {
                // Generate verification code
                verificationCode = Math.floor(100000 + Math.random() * 900000).toString();
                
                // Store pending user data
                pendingUser = {
                    id: 'user_' + Date.now(),
                    name: name,
                    email: email,
                    password: password, // In real app, this should be hashed
                    avatar: getAvatarInitials(name),
                    plan: 'free',
                    createdAt: new Date().toISOString(),
                    provider: 'email',
                    verified: false
                };
                
                // Save to pending users
                const pendingUsers = JSON.parse(localStorage.getItem('cyanix_pending_users') || '[]');
                pendingUsers.push({
                    user: pendingUser,
                    verificationCode: verificationCode,
                    expiresAt: Date.now() + 5 * 60 * 1000 // 5 minutes
                });
                localStorage.setItem('cyanix_pending_users', JSON.stringify(pendingUsers));
                
                // Send verification email (simulated)
                sendVerificationEmail(email, verificationCode);
                
                // Show verification screen
                document.getElementById('authContainer').style.display = 'none';
                document.getElementById('verificationContainer').classList.add('active');
                document.getElementById('verificationEmail').textContent = email;
                
                // Start timer
                startVerificationTimer();
                
                // Focus first code input
                document.querySelector('.code-input').focus();
                
                // Reset button
                signupBtn.innerHTML = originalText;
                signupBtn.disabled = false;
                
                console.log('Sign up successful, verification code:', verificationCode); // Debug log
            }, 1500);
        }

        function getAvatarInitials(name) {
            return name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
        }

        function sendVerificationEmail(email, code) {
            // In production, this would call your backend API
            // For demo, we'll simulate email sending
            console.log(`ðŸ“§ Verification code for ${email}: ${code}`);
            
            // Show success message
            showToast(`Verification code sent to ${email}. Check your inbox!`, 'success');
            
            // In demo, also show the code in an alert for testing
            setTimeout(() => {
                alert(`DEMO: Your verification code is ${code}\n\nIn production, this would be sent via email.\n\nUse this code to complete verification.`);
            }, 500);
        }

        // ==================== VERIFICATION FUNCTIONS ====================
        function startVerificationTimer() {
            let timeLeft = 300; // 5 minutes in seconds
            const timerElement = document.getElementById('timer');
            const resendLink = document.getElementById('resendLink');
            
            // Disable resend link initially
            resendLink.classList.add('disabled');
            
            // Update timer every second
            verificationTimer = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(verificationTimer);
                    resendLink.classList.remove('disabled');
                    showToast('Verification code expired', 'warning');
                }
                
                timeLeft--;
            }, 1000);
        }

        function moveToNext(input, nextIndex) {
            // Allow only numbers
            input.value = input.value.replace(/\D/g, '');
            
            // Move to next input if value entered
            if (input.value && nextIndex <= 6) {
                const nextInput = document.querySelector(`.code-input:nth-child(${nextIndex})`);
                if (nextInput) nextInput.focus();
            }
            
            // Auto-submit if all fields filled
            const inputs = document.querySelectorAll('.code-input');
            const allFilled = Array.from(inputs).every(input => input.value.length === 1);
            if (allFilled && nextIndex === 6) {
                verifyEmailCode();
            }
        }

        function handleCodeKeyUp(event, currentIndex) {
            if (event.key === 'Backspace') {
                const currentInput = document.querySelector(`.code-input:nth-child(${currentIndex})`);
                if (!currentInput.value && currentIndex > 1) {
                    const prevInput = document.querySelector(`.code-input:nth-child(${currentIndex - 1})`);
                    if (prevInput) prevInput.focus();
                }
            }
        }

        function verifyEmailCode() {
            const inputs = document.querySelectorAll('.code-input');
            const enteredCode = Array.from(inputs).map(input => input.value).join('');
            
            if (enteredCode.length !== 6) {
                showToast('Please enter the 6-digit code', 'error');
                return;
            }
            
            // Get pending users from localStorage
            const pendingUsers = JSON.parse(localStorage.getItem('cyanix_pending_users') || '[]');
            const pendingUserData = pendingUsers.find(pu => pu.user.email === pendingUser?.email);
            
            if (!pendingUserData) {
                showToast('Verification session expired. Please sign up again.', 'error');
                goBackToSignup();
                return;
            }
            
            if (enteredCode !== pendingUserData.verificationCode) {
                showToast('Invalid verification code. Please try again.', 'error');
                
                // Clear inputs with shake animation
                inputs.forEach(input => {
                    input.style.animation = 'shake 0.5s';
                    setTimeout(() => input.style.animation = '', 500);
                });
                
                // Focus first input
                inputs[0].focus();
                return;
            }
            
            // Code is correct
            clearInterval(verificationTimer);
            
            // Mark user as verified
            pendingUser.verified = true;
            pendingUser.verifiedAt = new Date().toISOString();
            
            // Remove from pending users
            const updatedPendingUsers = pendingUsers.filter(pu => pu.user.email !== pendingUser.email);
            localStorage.setItem('cyanix_pending_users', JSON.stringify(updatedPendingUsers));
            
            // Add to regular users
            const existingUsers = JSON.parse(localStorage.getItem('cyanix_users') || '[]');
            existingUsers.push(pendingUser);
            localStorage.setItem('cyanix_users', JSON.stringify(existingUsers));
            
            // Set as current user
            currentUser = { ...pendingUser };
            delete currentUser.password;
            
            // Save user session
            localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
            
            // Hide verification screen
            document.getElementById('verificationContainer').classList.remove('active');
            
            // Show chat interface
            showChatInterface();
            
            // Show welcome message
            setTimeout(() => {
                showToast('Email verified successfully! Welcome to Cyanix AI!', 'success');
            }, 500);
            
            // Reset pending user
            pendingUser = null;
            verificationCode = null;
        }

        function resendVerificationCode() {
            const resendLink = document.getElementById('resendLink');
            if (resendLink.classList.contains('disabled')) return;
            
            // Generate new code
            verificationCode = Math.floor(100000 + Math.random() * 900000).toString();
            
            // Update pending user data
            const pendingUsers = JSON.parse(localStorage.getItem('cyanix_pending_users') || '[]');
            const pendingUserIndex = pendingUsers.findIndex(pu => pu.user.email === pendingUser?.email);
            
            if (pendingUserIndex !== -1) {
                pendingUsers[pendingUserIndex].verificationCode = verificationCode;
                pendingUsers[pendingUserIndex].expiresAt = Date.now() + 5 * 60 * 1000;
                localStorage.setItem('cyanix_pending_users', JSON.stringify(pendingUsers));
            }
            
            // Send new code
            sendVerificationEmail(pendingUser.email, verificationCode);
            
            // Reset timer
            clearInterval(verificationTimer);
            startVerificationTimer();
            
            // Clear input fields
            const inputs = document.querySelectorAll('.code-input');
            inputs.forEach(input => input.value = '');
            inputs[0].focus();
            
            showToast('New verification code sent!', 'success');
        }

        function goBackToSignup() {
            document.getElementById('verificationContainer').classList.remove('active');
            document.getElementById('authContainer').style.display = 'flex';
            clearInterval(verificationTimer);
            
            // Switch to signup tab
            switchAuthTab('signup');
        }

        // ==================== SIGN IN FUNCTION ====================
        function signInWithEmail() {
            const email = document.getElementById('signinEmail').value.trim();
            const password = document.getElementById('signinPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            // Clear previous errors
            clearErrors();
            
            // Validation
            if (!email) {
                showError('signinEmailError', 'Please enter your email address');
                return;
            }
            
            if (!validateEmail(email)) {
                showError('signinEmailError', 'Please enter a valid email address');
                return;
            }
            
            if (!password) {
                showError('signinPasswordError', 'Please enter your password');
                return;
            }
            
            // Show loading
            const signinBtn = document.getElementById('signinBtn');
            const originalText = signinBtn.innerHTML;
            signinBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing In...';
            signinBtn.disabled = true;
            
            // Simulate API call
            setTimeout(() => {
                // Check users in localStorage
                const existingUsers = JSON.parse(localStorage.getItem('cyanix_users') || '[]');
                const user = existingUsers.find(u => u.email === email && u.password === password);
                
                if (user) {
                    if (!user.verified && user.provider === 'email') {
                        showError('signinEmailError', 'Please verify your email first');
                        showToast('Please verify your email before signing in', 'error');
                    } else {
                        // Successful login
                        currentUser = {
                            id: user.id,
                            name: user.name,
                            email: user.email,
                            avatar: user.avatar,
                            plan: user.plan || 'free',
                            createdAt: user.createdAt,
                            verified: user.verified
                        };
                        
                        // Save user session
                        if (rememberMe) {
                            localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                        } else {
                            sessionStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                        }
                        
                        showChatInterface();
                        showToast('Welcome back!', 'success');
                    }
                } else {
                    showError('signinEmailError', 'Invalid email or password');
                    showToast('Invalid email or password', 'error');
                }
                
                // Reset button
                signinBtn.innerHTML = originalText;
                signinBtn.disabled = false;
            }, 1500);
        }

        // ==================== SOCIAL AUTHENTICATION ====================
        function signInWithGoogle() {
            // Simulate Google OAuth
            showToast('Connecting to Google...', 'info');
            
            // Disable button
            const btn = event.target.closest('button');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            btn.disabled = true;
            
            setTimeout(() => {
                // Google users are auto-verified
                const googleUser = {
                    id: 'google_' + Date.now(),
                    name: 'Google User',
                    email: 'user@gmail.com',
                    avatar: 'G',
                    plan: 'free',
                    provider: 'google',
                    verified: true,
                    createdAt: new Date().toISOString()
                };
                
                // Check if user exists
                const existingUsers = JSON.parse(localStorage.getItem('cyanix_users') || '[]');
                let user = existingUsers.find(u => u.email === googleUser.email);
                
                if (!user) {
                    user = googleUser;
                    existingUsers.push(user);
                    localStorage.setItem('cyanix_users', JSON.stringify(existingUsers));
                }
                
                currentUser = { ...user };
                delete currentUser.password;
                
                localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                showChatInterface();
                showToast('Signed in with Google', 'success');
                
                // Reset button
                btn.innerHTML = originalHTML;
                btn.disabled = false;
            }, 1500);
        }

        function signUpWithGoogle() {
            signInWithGoogle();
        }

        function signInWithMicrosoft() {
            showToast('Connecting to Microsoft...', 'info');
            
            // Disable button
            const btn = event.target.closest('button');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            btn.disabled = true;
            
            setTimeout(() => {
                // Microsoft users are auto-verified
                const microsoftUser = {
                    id: 'microsoft_' + Date.now(),
                    name: 'Microsoft User',
                    email: 'user@outlook.com',
                    avatar: 'M',
                    plan: 'free',
                    provider: 'microsoft',
                    verified: true,
                    createdAt: new Date().toISOString()
                };
                
                // Check if user exists
                const existingUsers = JSON.parse(localStorage.getItem('cyanix_users') || '[]');
                let user = existingUsers.find(u => u.email === microsoftUser.email);
                
                if (!user) {
                    user = microsoftUser;
                    existingUsers.push(user);
                    localStorage.setItem('cyanix_users', JSON.stringify(existingUsers));
                }
                
                currentUser = { ...user };
                delete currentUser.password;
                
                localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                showChatInterface();
                showToast('Signed in with Microsoft', 'success');
                
                // Reset button
                btn.innerHTML = originalHTML;
                btn.disabled = false;
            }, 1500);
        }

        function signUpWithMicrosoft() {
            signInWithMicrosoft();
        }

        // ==================== CHAT INTERFACE ====================
        function showChatInterface() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('verificationContainer').classList.remove('active');
            
            // Create and show chat interface
            const chatHTML = `
                <div id="chatContainer" style="height: 100vh; display: flex; flex-direction: column; background: var(--purple-dark);">
                    <div style="padding: 20px; background: rgba(0, 168, 181, 0.1); border-bottom: 1px solid var(--cyan-primary);">
                        <h1 style="color: var(--cyan-primary); text-align: center;">Cyanix AI</h1>
                    </div>
                    <div style="flex: 1; padding: 20px; overflow-y: auto;">
                        <div style="max-width: 800px; margin: 0 auto; text-align: center; padding-top: 60px;">
                            <div style="font-size: 64px; margin-bottom: 30px; color: var(--cyan-primary);">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h1 style="font-size: 48px; font-weight: 700; background: linear-gradient(135deg, var(--cyan-primary), var(--cyan-light)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px;">
                                Welcome to Cyanix AI!
                            </h1>
                            <p style="font-size: 18px; color: var(--cyan-light); opacity: 0.8; max-width: 600px; margin: 0 auto 40px; line-height: 1.6;">
                                Hello ${currentUser?.name || 'User'}! I'm your intelligent assistant. I can help with writing, analysis, coding, creative tasks, and much more.
                            </p>
                            <button onclick="startNewChat()" style="padding: 15px 30px; background: var(--cyan-primary); color: var(--purple-dark); border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 20px;">
                                Start New Chat
                            </button>
                        </div>
                    </div>
                    <div style="padding: 20px; background: rgba(13, 2, 33, 0.95); border-top: 1px solid rgba(0, 243, 255, 0.1);">
                        <div style="max-width: 800px; margin: 0 auto; display: flex; gap: 10px;">
                            <input type="text" id="chatInput" placeholder="Message Cyanix AI..." style="flex: 1; padding: 15px; background: rgba(0, 168, 181, 0.1); border: 2px solid rgba(0, 243, 255, 0.2); border-radius: 12px; color: white; font-size: 16px;">
                            <button onclick="sendMessage()" style="padding: 15px 30px; background: var(--cyan-primary); color: var(--purple-dark); border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer;">
                                Send
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            const chatContainer = document.createElement('div');
            chatContainer.innerHTML = chatHTML;
            document.body.appendChild(chatContainer);
            
            // Add logout button
            const logoutBtn = document.createElement('button');
            logoutBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
            logoutBtn.style.cssText = 'position: fixed; top: 20px; right: 20px; padding: 10px 20px; background: rgba(255, 71, 87, 0.1); color: #ff4757; border: 1px solid #ff4757; border-radius: 8px; cursor: pointer;';
            logoutBtn.onclick = logout;
            document.body.appendChild(logoutBtn);
        }

        function startNewChat() {
            showToast('Starting new chat...', 'info');
            // In a full implementation, this would initialize a new chat session
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) {
                showToast('Please enter a message', 'error');
                return;
            }
            
            showToast('Message sent! (Demo mode)', 'success');
            input.value = '';
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                currentUser = null;
                localStorage.removeItem('cyanix_user');
                sessionStorage.removeItem('cyanix_user');
                
                // Remove chat interface
                document.querySelector('#chatContainer')?.remove();
                document.querySelector('button[onclick="logout"]')?.remove();
                
                // Show auth container
                document.getElementById('authContainer').style.display = 'flex';
                switchAuthTab('signin');
                
                showToast('Logged out successfully', 'success');
            }
        }

        // ==================== MODAL FUNCTIONS ====================
        function showTermsModal() {
            document.getElementById('termsModal').classList.add('active');
        }

        function hideTermsModal() {
            document.getElementById('termsModal').classList.remove('active');
        }

        function acceptTerms() {
            document.getElementById('acceptTerms').checked = true;
            hideTermsModal();
            showToast('Terms accepted', 'success');
        }

        function showForgotPassword() {
            document.getElementById('forgotPasswordModal').classList.add('active');
        }

        function hideForgotPassword() {
            document.getElementById('forgotPasswordModal').classList.remove('active');
        }

        function sendResetEmail() {
            const email = document.getElementById('resetEmail').value;
            if (!email) {
                showError('resetEmailError', 'Please enter your email address');
                return;
            }
            
            if (!validateEmail(email)) {
                showError('resetEmailError', 'Please enter a valid email address');
                return;
            }
            
            // Simulate sending reset email
            showToast('Password reset email sent! Check your inbox.', 'success');
            hideForgotPassword();
        }
    </script>
</body>
</html>ges</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Priority responses</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Advanced file support</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Unlimited history</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Voice input/output</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Code execution</li>
                    </ul>
                    <button class="modal-btn primary" style="width: 100%;" onclick="upgradeToPro()">
                        Upgrade Now
                    </button>
                </div>
                
                <div class="plan-card">
                    <div class="plan-name">Team</div>
                    <div class="plan-price">$24.99</div>
                    <div class="plan-period">per user/month</div>
                    <ul class="plan-features">
                        <li class="plan-feature"><i class="fas fa-check"></i> Everything in Pro</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Team collaboration</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Admin dashboard</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> API access</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Priority support</li>
                        <li class="plan-feature"><i class="fas fa-check"></i> Custom models</li>
                    </ul>
                    <button class="modal-btn secondary" style="width: 100%;" onclick="upgradeToTeam()">
                        Contact Sales
                    </button>
                </div>
            </div>
            
            <button class="modal-btn secondary" onclick="hideUpgradeModal()" style="width: 100%; margin-top: 20px;">
                Maybe Later
            </button>
        </div>
    </div>

    <!-- File Upload Modal -->
    <div id="fileUploadModal" class="modal-overlay">
        <div class="modal file-upload-modal">
            <div class="modal-header">
                <h2 class="modal-title">Upload Files</h2>
                <p class="modal-subtitle">Upload files for AI analysis or reference</p>
            </div>
            
            <div class="upload-area" onclick="triggerFileUpload()">
                <div class="upload-icon">
                    <i class="fas fa-cloud-upload-alt"></i>
                </div>
                <div class="upload-text">Click to upload or drag and drop</div>
                <div class="upload-hint">Supports: PDF, TXT, DOC, IMAGES, CODE (max 10MB)</div>
                <input type="file" id="fileInput" multiple style="display: none;" onchange="handleFileUpload(this.files)">
            </div>
            
            <div id="uploadedFiles" style="margin-top: 20px;"></div>
            
            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="hideFileUploadModal()">Cancel</button>
                <button class="modal-btn primary" onclick="processUploadedFiles()">Analyze Files</button>
            </div>
        </div>
    </div>

    <!-- Voice Recording Modal -->
    <div id="voiceRecording" class="voice-recording">
        <div style="text-align: center;">
            <div class="verification-icon">
                <i class="fas fa-microphone"></i>
            </div>
            <h3 class="verification-title">Listening...</h3>
            <p class="verification-subtitle">Speak now. Click stop when done.</p>
            
            <div class="voice-animation">
                <div class="voice-bar"></div>
                <div class="voice-bar"></div>
                <div class="voice-bar"></div>
                <div class="voice-bar"></div>
                <div class="voice-bar"></div>
            </div>
            
            <div style="margin-top: 30px; display: flex; gap: 10px;">
                <button class="modal-btn secondary" onclick="stopVoiceRecording()">
                    <i class="fas fa-stop"></i> Stop
                </button>
                <button class="modal-btn primary" onclick="cancelVoiceRecording()">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" class="modal-overlay">
        <div class="modal share-modal">
            <div class="modal-header">
                <h2 class="modal-title">Share Conversation</h2>
                <p class="modal-subtitle">Share this conversation with others</p>
            </div>
            
            <div class="share-options">
                <div class="share-option" onclick="shareViaEmail()">
                    <div class="share-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="share-label">Email</div>
                </div>
                <div class="share-option" onclick="shareViaWhatsApp()">
                    <div class="share-icon">
                        <i class="fab fa-whatsapp"></i>
                    </div>
                    <div class="share-label">WhatsApp</div>
                </div>
                <div class="share-option" onclick="shareViaTwitter()">
                    <div class="share-icon">
                        <i class="fab fa-twitter"></i>
                    </div>
                    <div class="share-label">Twitter</div>
                </div>
                <div class="share-option" onclick="copyShareLink()">
                    <div class="share-icon">
                        <i class="fas fa-link"></i>
                    </div>
                    <div class="share-label">Copy Link</div>
                </div>
            </div>
            
            <div class="share-link">
                <input type="text" id="shareLinkInput" value="https://cyanix.ai/chat/abc123" readonly>
                <button class="input-btn" onclick="copyShareLink()">
                    <i class="fas fa-copy"></i>
                </button>
            </div>
            
            <div class="settings-option">
                <div>
                    <div class="option-label">Include my messages</div>
                    <div class="option-description">Share both my questions and AI responses</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="includeMyMessages" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="hideShareModal()">Close</button>
                <button class="modal-btn primary" onclick="generateShareLink()">Generate Link</button>
            </div>
        </div>
    </div>

    <!-- Chat Interface -->
    <div id="chatContainer" class="chat-container">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="sidebar-logo-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="sidebar-logo-text">Cyanix AI</div>
                </div>
            </div>
            
            <div class="sidebar-content">
                <button class="new-chat-btn" onclick="newChat()">
                    <i class="fas fa-plus"></i>
                    New Chat
                </button>
                
                <div class="history-section">
                    <div class="section-title">Today</div>
                    <ul class="conversation-list" id="todayConversations">
                        <!-- Today's conversations will be added here -->
                    </ul>
                </div>
                
                <div class="history-section">
                    <div class="section-title">Yesterday</div>
                    <ul class="conversation-list" id="yesterdayConversations">
                        <!-- Yesterday's conversations will be added here -->
                    </ul>
                </div>
                
                <div class="history-section">
                    <div class="section-title">Previous 7 Days</div>
                    <ul class="conversation-list" id="weekConversations">
                        <!-- Week's conversations will be added here -->
                    </ul>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="user-profile" onclick="toggleUserMenu()">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-info">
                        <div class="user-name" id="userName">User</div>
                        <div class="user-email" id="userEmail">user@example.com</div>
                    </div>
                    <button class="user-menu-btn">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- User Menu -->
        <div id="userMenu" class="user-menu">
            <div class="menu-item" onclick="showProfileModal()">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </div>
            <div class="menu-item" onclick="showSettingsModal()">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
            <div class="menu-item" onclick="showUpgradeModal()">
                <i class="fas fa-crown"></i>
                <span>Upgrade to Pro</span>
            </div>
            <div class="menu-item" onclick="exportData()">
                <i class="fas fa-download"></i>
                <span>Export Data</span>
            </div>
            <div class="menu-item danger" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </div>
        </div>
        
        <!-- Main Chat Area -->
        <div class="main-chat" id="mainChat">
            <div class="chat-header">
                <button class="menu-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="chat-title" id="chatTitle">New Chat</div>
                <div class="chat-actions">
                    <button class="header-btn" onclick="clearChat()">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                    <button class="header-btn" onclick="showShareModal()">
                        <i class="fas fa-share-alt"></i>
                    </button>
                    <button class="header-btn" onclick="toggleDarkMode()">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
            
            <div class="messages-container" id="messagesContainer">
                <!-- Welcome Screen -->
                <div id="welcomeScreen" class="welcome-screen">
                    <div class="welcome-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h1 class="welcome-title">How can I help you today?</h1>
                    <p class="welcome-subtitle">
                        I'm Cyanix AI, your intelligent assistant. I can help with writing, analysis, coding, 
                        creative tasks, and much more. What would you like to explore?
                    </p>
                    
                    <div class="example-prompts">
                        <div class="example-prompt" onclick="useExample('brainstorm')">
                            <div class="example-title">
                                <i class="fas fa-lightbulb"></i>
                                Brainstorm ideas
                            </div>
                            <div class="example-text">"Help me brainstorm creative project ideas for a tech startup"</div>
                        </div>
                        <div class="example-prompt" onclick="useExample('explain')">
                            <div class="example-title">
                                <i class="fas fa-book"></i>
                                Explain concepts
                            </div>
                            <div class="example-text">"Explain quantum computing in simple terms"</div>
                        </div>
                        <div class="example-prompt" onclick="useExample('code')">
                            <div class="example-title">
                                <i class="fas fa-code"></i>
                                Write code
                            </div>
                            <div class="example-text">"Write a Python function to sort a list using quicksort"</div>
                        </div>
                        <div class="example-prompt" onclick="useExample('analyze')">
                            <div class="example-title">
                                <i class="fas fa-chart-line"></i>
                                Analyze data
                            </div>
                            <div class="example-text">"Analyze the pros and cons of renewable energy sources"</div>
                        </div>
                    </div>
                </div>
                
                <!-- Messages will be inserted here -->
            </div>
            
            <div class="input-container">
                <div class="input-wrapper">
                    <textarea 
                        id="chatInput" 
                        class="chat-input" 
                        placeholder="Message Cyanix AI... (Press Ctrl+Enter for voice, Ctrl+U for upload)"
                        rows="1"
                        oninput="autoResizeInput(this)"
                        onkeydown="handleKeyDown(event)"
                    ></textarea>
                    <div class="input-buttons">
                        <button class="input-btn" onclick="showFileUploadModal()">
                            <i class="fas fa-paperclip"></i>
                        </button>
                        <button class="input-btn" onclick="startVoiceRecording()">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button class="input-btn" onclick="toggleImageMode()">
                            <i class="fas fa-image"></i>
                        </button>
                        <button class="input-btn send" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== APP STATE ====================
        let currentUser = null;
        let currentChatId = null;
        let conversations = [];
        let isSidebarOpen = false;
        let isDarkMode = true;
        let userMenuOpen = false;
        let verificationCode = null;
        let verificationTimer = null;
        let pendingUser = null;
        let voiceRecordingActive = false;
        let uploadedFiles = [];

        // Mock database for demo purposes
        const mockDatabase = {
            users: [],
            conversations: [],
            messages: []
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            initApp();
        });

        function initApp() {
            // Hide splash screen after delay
            setTimeout(() => {
                document.getElementById('splashScreen').style.display = 'none';
                
                // Check if user is already logged in
                const savedUser = localStorage.getItem('cyanix_user');
                if (savedUser) {
                    currentUser = JSON.parse(savedUser);
                    showChatInterface();
                    loadConversations();
                }
            }, 2000);
            
            // Initialize form event listeners
            initializeAuthForms();
        }

        // ==================== EMAIL VERIFICATION SYSTEM ====================
        function generateVerificationCode() {
            // Generate 6-digit code
            return Math.floor(100000 + Math.random() * 900000).toString();
        }

        function sendVerificationEmail(email, code) {
            // In production, this would call your backend API
            // For demo, we'll simulate email sending
            console.log(`ðŸ“§ Verification code for ${email}: ${code}`);
            
            // Show success message
            showToast(`Verification code sent to ${email}. Check your inbox!`, 'success');
            
            // In demo, also show the code in an alert for testing
            alert(`DEMO: Your verification code is ${code}\n\nIn production, this would be sent via email.`);
        }

        function startVerificationTimer() {
            let timeLeft = 300; // 5 minutes in seconds
            const timerElement = document.getElementById('timer');
            const resendLink = document.getElementById('resendLink');
            
            // Disable resend link initially
            resendLink.classList.add('disabled');
            
            // Update timer every second
            verificationTimer = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(verificationTimer);
                    resendLink.classList.remove('disabled');
                    showToast('Verification code expired', 'warning');
                }
                
                timeLeft--;
            }, 1000);
        }

        function resendVerificationCode() {
            const resendLink = document.getElementById('resendLink');
            if (resendLink.classList.contains('disabled')) return;
            
            // Generate new code
            verificationCode = generateVerificationCode();
            
            // Send new code
            sendVerificationEmail(pendingUser.email, verificationCode);
            
            // Reset timer
            clearInterval(verificationTimer);
            startVerificationTimer();
            
            // Clear input fields
            const inputs = document.querySelectorAll('.code-input');
            inputs.forEach(input => input.value = '');
            inputs[0].focus();
            
            showToast('New verification code sent!', 'success');
        }

        function moveToNext(input, nextIndex) {
            // Allow only numbers
            input.value = input.value.replace(/\D/g, '');
            
            // Move to next input if value entered
            if (input.value && nextIndex <= 6) {
                const nextInput = document.querySelector(`.code-input:nth-child(${nextIndex})`);
                if (nextInput) nextInput.focus();
            }
            
            // Auto-submit if all fields filled
            const inputs = document.querySelectorAll('.code-input');
            const allFilled = Array.from(inputs).every(input => input.value.length === 1);
            if (allFilled && nextIndex === 6) {
                verifyEmailCode();
            }
        }

        function verifyEmailCode() {
            const inputs = document.querySelectorAll('.code-input');
            const enteredCode = Array.from(inputs).map(input => input.value).join('');
            
            if (enteredCode.length !== 6) {
                showToast('Please enter the 6-digit code', 'error');
                return;
            }
            
            if (enteredCode === verificationCode) {
                // Code is correct
                clearInterval(verificationTimer);
                
                // Mark user as verified
                pendingUser.verified = true;
                pendingUser.verifiedAt = new Date().toISOString();
                
                // Add to mock database
                mockDatabase.users.push(pendingUser);
                
                // Set as current user
                currentUser = { ...pendingUser };
                delete currentUser.password;
                
                // Save user session
                localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                
                // Hide verification screen
                document.getElementById('verificationContainer').classList.remove('active');
                
                // Show chat interface
                showChatInterface();
                showWelcomeMessage();
                showToast('Email verified successfully! Welcome to Cyanix AI!', 'success');
                
                // Reset pending user
                pendingUser = null;
                verificationCode = null;
            } else {
                // Wrong code
                showToast('Invalid verification code. Please try again.', 'error');
                
                // Clear inputs with shake animation
                inputs.forEach(input => {
                    input.style.animation = 'shake 0.5s';
                    setTimeout(() => input.style.animation = '', 500);
                });
                
                // Focus first input
                inputs[0].focus();
            }
        }

        function goBackToSignup() {
            document.getElementById('verificationContainer').classList.remove('active');
            document.getElementById('authContainer').style.display = 'flex';
            clearInterval(verificationTimer);
        }

        // ==================== AUTHENTICATION ====================
        function initializeAuthForms() {
            // Add enter key support for forms
            document.getElementById('signinEmail')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') signInWithEmail();
            });
            
            document.getElementById('signinPassword')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') signInWithEmail();
            });
            
            document.getElementById('signupEmail')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') signUpWithEmail();
            });
            
            document.getElementById('signupPassword')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') signUpWithEmail();
            });
        }

        function switchAuthTab(tab) {
            const signinTab = document.querySelector('[onclick="switchAuthTab(\'signin\')"]');
            const signupTab = document.querySelector('[onclick="switchAuthTab(\'signup\')"]');
            const signinForm = document.getElementById('signinForm');
            const signupForm = document.getElementById('signupForm');
            
            if (tab === 'signin') {
                signinTab.classList.add('active');
                signupTab.classList.remove('active');
                signinForm.style.display = 'block';
                signupForm.style.display = 'none';
            } else {
                signinTab.classList.remove('active');
                signupTab.classList.add('active');
                signinForm.style.display = 'none';
                signupForm.style.display = 'block';
            }
        }

        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const toggle = input.nextElementSibling.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                toggle.classList.remove('fa-eye');
                toggle.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                toggle.classList.remove('fa-eye-slash');
                toggle.classList.add('fa-eye');
            }
        }

        function signInWithEmail() {
            const email = document.getElementById('signinEmail').value.trim();
            const password = document.getElementById('signinPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            if (!validateEmail(email)) {
                showToast('Please enter a valid email address', 'error');
                return;
            }
            
            if (password.length < 6) {
                showToast('Password must be at least 6 characters', 'error');
                return;
            }
            
            // Show loading
            const btn = document.querySelector('#signinForm .auth-btn');
            const originalText = btn.textContent;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing In...';
            btn.disabled = true;
            
            // Simulate API call
            setTimeout(() => {
                // Check mock database
                let user = mockDatabase.users.find(u => u.email === email && u.password === password);
                
                if (user) {
                    if (!user.verified && user.provider === 'email') {
                        showToast('Please verify your email first', 'error');
                    } else {
                        // Successful login
                        currentUser = {
                            id: user.id,
                            name: user.name,
                            email: user.email,
                            avatar: user.avatar,
                            plan: user.plan || 'free',
                            createdAt: user.createdAt,
                            verified: user.verified
                        };
                        
                        // Save user session
                        if (rememberMe) {
                            localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                        } else {
                            sessionStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                        }
                        
                        showChatInterface();
                        loadConversations();
                        showToast('Welcome back!', 'success');
                    }
                } else {
                    showToast('Invalid email or password', 'error');
                }
                
                // Reset button
                btn.textContent = originalText;
                btn.disabled = false;
            }, 1500);
        }

        function signUpWithEmail() {
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const acceptTerms = document.getElementById('acceptTerms').checked;
            
            // Validation
            if (!name) {
                showToast('Please enter your name', 'error');
                return;
            }
            
            if (!validateEmail(email)) {
                showToast('Please enter a valid email address', 'error');
                return;
            }
            
            if (password.length < 8) {
                showToast('Password must be at least 8 characters', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showToast('Passwords do not match', 'error');
                return;
            }
            
            if (!acceptTerms) {
                showToast('Please accept the terms and privacy policy', 'error');
                return;
            }
            
            // Check if user already exists
            if (mockDatabase.users.some(u => u.email === email)) {
                showToast('An account with this email already exists', 'error');
                return;
            }
            
            // Show loading
            const btn = document.querySelector('#signupForm .auth-btn');
            const originalText = btn.textContent;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';
            btn.disabled = true;
            
            // Simulate API call
            setTimeout(() => {
                // Create user object
                pendingUser = {
                    id: 'user_' + Date.now(),
                    name: name,
                    email: email,
                    password: password,
                    avatar: getAvatarInitials(name),
                    plan: 'free',
                    createdAt: new Date().toISOString(),
                    provider: 'email',
                    verified: false
                };
                
                // Generate verification code
                verificationCode = generateVerificationCode();
                
                // Send verification email
                sendVerificationEmail(email, verificationCode);
                
                // Show verification screen
                document.getElementById('authContainer').style.display = 'none';
                document.getElementById('verificationContainer').classList.add('active');
                document.getElementById('verificationEmail').textContent = email;
                
                // Start timer
                startVerificationTimer();
                
                // Focus first code input
                document.querySelector('.code-input').focus();
                
                // Reset button
                btn.textContent = originalText;
                btn.disabled = false;
            }, 2000);
        }

        function signInWithGoogle() {
            // Simulate Google OAuth
            showToast('Connecting to Google...', 'info');
            
            setTimeout(() => {
                // Google users are auto-verified
                const googleUser = {
                    id: 'google_' + Date.now(),
                    name: 'Google User',
                    email: 'user@gmail.com',
                    avatar: 'G',
                    plan: 'free',
                    provider: 'google',
                    verified: true,
                    createdAt: new Date().toISOString()
                };
                
                // Check if user exists
                let user = mockDatabase.users.find(u => u.email === googleUser.email);
                if (!user) {
                    user = googleUser;
                    mockDatabase.users.push(user);
                }
                
                currentUser = { ...user };
                delete currentUser.password;
                
                localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                showChatInterface();
                loadConversations();
                showToast('Signed in with Google', 'success');
            }, 1500);
        }

        function signUpWithGoogle() {
            signInWithGoogle();
        }

        function signInWithMicrosoft() {
            showToast('Connecting to Microsoft...', 'info');
            
            setTimeout(() => {
                // Microsoft users are auto-verified
                const microsoftUser = {
                    id: 'microsoft_' + Date.now(),
                    name: 'Microsoft User',
                    email: 'user@outlook.com',
                    avatar: 'M',
                    plan: 'free',
                    provider: 'microsoft',
                    verified: true,
                    createdAt: new Date().toISOString()
                };
                
                // Check if user exists
                let user = mockDatabase.users.find(u => u.email === microsoftUser.email);
                if (!user) {
                    user = microsoftUser;
                    mockDatabase.users.push(user);
                }
                
                currentUser = { ...user };
                delete currentUser.password;
                
                localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                showChatInterface();
                loadConversations();
                showToast('Signed in with Microsoft', 'success');
            }, 1500);
        }

        function signUpWithMicrosoft() {
            signInWithMicrosoft();
        }

        // ==================== FILE UPLOAD FEATURE ====================
        function showFileUploadModal() {
            document.getElementById('fileUploadModal').classList.add('active');
        }

        function hideFileUploadModal() {
            document.getElementById('fileUploadModal').classList.remove('active');
        }

        function triggerFileUpload() {
            document.getElementById('fileInput').click();
        }

        function handleFileUpload(files) {
            const uploadedFilesDiv = document.getElementById('uploadedFiles');
            uploadedFilesDiv.innerHTML = '';
            
            uploadedFiles = Array.from(files);
            
            uploadedFiles.forEach((file, index) => {
                const fileDiv = document.createElement('div');
                fileDiv.className = 'settings-option';
                fileDiv.innerHTML = `
                    <div>
                        <div class="option-label">${file.name}</div>
                        <div class="option-description">${formatFileSize(file.size)} â€¢ ${file.type}</div>
                    </div>
                    <button class="input-btn" onclick="removeFile(${index})">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                uploadedFilesDiv.appendChild(fileDiv);
            });
            
            showToast(`${files.length} file(s) selected`, 'success');
        }

        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            handleFileUpload(uploadedFiles);
        }

        function processUploadedFiles() {
            if (uploadedFiles.length === 0) {
                showToast('Please select files first', 'error');
                return;
            }
            
            // Simulate file processing
            showToast('Processing files...', 'info');
            
            setTimeout(() => {
                // Add message about files
                const fileNames = uploadedFiles.map(f => f.name).join(', ');
                const message = `I've uploaded ${uploadedFiles.length} file(s): ${fileNames}. You can ask me questions about these files.`;
                
                addMessageToUI(message, 'user');
                hideFileUploadModal();
                
                // Clear files
                uploadedFiles = [];
                document.getElementById('uploadedFiles').innerHTML = '';
                
                // Simulate AI response
                setTimeout(() => {
                    const response = `I can see you've uploaded ${uploadedFiles.length} file(s). I can help you analyze these files. Please tell me what specific information you'd like me to extract or analyze from them.`;
                    addMessageToUI(response, 'assistant');
                }, 1000);
            }, 2000);
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // ==================== VOICE INPUT FEATURE ====================
        function startVoiceRecording() {
            // Check if browser supports voice recognition
            if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
                showToast('Voice input not supported in your browser', 'error');
                return;
            }
            
            // Show recording interface
            document.getElementById('voiceRecording').classList.add('active');
            voiceRecordingActive = true;
            
            // In a real app, this would use the Web Speech API
            // For demo, we'll simulate voice recognition
            showToast('Voice recording started. Speak now!', 'info');
        }

        function stopVoiceRecording() {
            if (!voiceRecordingActive) return;
            
            // Hide recording interface
            document.getElementById('voiceRecording').classList.remove('active');
            voiceRecordingActive = false;
            
            // Simulate voice recognition result
            const sampleResponses = [
                "Hello, how can I help you today?",
                "I need help with my Python code",
                "What is the weather like today?",
                "Can you explain quantum computing?",
                "Create a business plan for a startup"
            ];
            
            const randomResponse = sampleResponses[Math.floor(Math.random() * sampleResponses.length)];
            
            // Set the recognized text in the input
            document.getElementById('chatInput').value = randomResponse;
            autoResizeInput(document.getElementById('chatInput'));
            
            showToast('Voice input captured', 'success');
        }

        function cancelVoiceRecording() {
            document.getElementById('voiceRecording').classList.remove('active');
            voiceRecordingActive = false;
            showToast('Voice recording cancelled', 'info');
        }

        // ==================== SHARE FEATURE ====================
        function showShareModal() {
            document.getElementById('shareModal').classList.add('active');
            
            // Generate share link
            generateShareLink();
        }

        function hideShareModal() {
            document.getElementById('shareModal').classList.remove('active');
        }

        function generateShareLink() {
            // In a real app, this would generate a unique shareable link
            const shareLink = `https://cyanix.ai/share/${currentChatId || 'demo'}`;
            document.getElementById('shareLinkInput').value = shareLink;
        }

        function copyShareLink() {
            const shareLink = document.getElementById('shareLinkInput');
            shareLink.select();
            shareLink.setSelectionRange(0, 99999);
            
            navigator.clipboard.writeText(shareLink.value)
                .then(() => showToast('Link copied to clipboard', 'success'))
                .catch(() => showToast('Failed to copy link', 'error'));
        }

        function shareViaEmail() {
            const subject = 'Check out this Cyanix AI conversation';
            const body = `I wanted to share this Cyanix AI conversation with you:\n\n${window.location.href}`;
            window.open(`mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`);
            hideShareModal();
        }

        function shareViaWhatsApp() {
            const text = 'Check out this Cyanix AI conversation: ' + window.location.href;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`);
            hideShareModal();
        }

        function shareViaTwitter() {
            const text = 'Check out this amazing AI conversation on Cyanix AI!';
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(window.location.href)}`);
            hideShareModal();
        }

        // ==================== PROFILE MODAL ====================
        function showProfileModal() {
            if (!currentUser) return;
            
            // Update profile info
            document.getElementById('profileAvatar').textContent = currentUser.avatar;
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileEmail').textContent = currentUser.email;
            
            // Calculate stats
            const totalChats = conversations.length;
            const totalMessages = conversations.reduce((sum, conv) => sum + (conv.messages?.length || 0), 0);
            const accountAge = currentUser.createdAt ? 
                Math.floor((new Date() - new Date(currentUser.createdAt)) / (1000 * 60 * 60 * 24)) : 0;
            
            document.getElementById('totalChats').textContent = totalChats;
            document.getElementById('totalMessages').textContent = totalMessages;
            document.getElementById('accountAge').textContent = accountAge + 'd';
            
            document.getElementById('profileModal').classList.add('active');
            toggleUserMenu();
        }

        function hideProfileModal() {
            document.getElementById('profileModal').classList.remove('active');
        }

        function saveProfileSettings() {
            // Save profile settings
            const emailNotifications = document.getElementById('emailNotifications').checked;
            const marketingEmails = document.getElementById('marketingEmails').checked;
            
            // In a real app, this would save to backend
            localStorage.setItem('email_notifications', emailNotifications);
            localStorage.setItem('marketing_emails', marketingEmails);
            
            showToast('Profile settings saved', 'success');
            hideProfileModal();
        }

        // ==================== SETTINGS MODAL ====================
        function showSettingsModal() {
            // Load current settings
            const savedModel = localStorage.getItem('ai_model') || 'cyanix';
            const savedLength = localStorage.getItem('response_length') || 'medium';
            const saveHistory = localStorage.getItem('save_history') !== 'false';
            const autoClearData = localStorage.getItem('auto_clear_data') !== 'false';
            const voiceResponses = localStorage.getItem('voice_responses') === 'true';
            const voiceSpeed = localStorage.getItem('voice_speed') || 'normal';
            
            document.getElementById('aiModel').value = savedModel;
            document.getElementById('responseLength').value = savedLength;
            document.getElementById('saveHistory').checked = saveHistory;
            document.getElementById('autoClearData').checked = autoClearData;
            document.getElementById('voiceResponses').checked = voiceResponses;
            document.getElementById('voiceSpeed').value = voiceSpeed;
            
            document.getElementById('settingsModal').classList.add('active');
            toggleUserMenu();
        }

        function hideSettingsModal() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function saveSettings() {
            // Get settings values
            const aiModel = document.getElementById('aiModel').value;
            const responseLength = document.getElementById('responseLength').value;
            const saveHistory = document.getElementById('saveHistory').checked;
            const autoClearData = document.getElementById('autoClearData').checked;
            const voiceResponses = document.getElementById('voiceResponses').checked;
            const voiceSpeed = document.getElementById('voiceSpeed').value;
            
            // Save to localStorage
            localStorage.setItem('ai_model', aiModel);
            localStorage.setItem('response_length', responseLength);
            localStorage.setItem('save_history', saveHistory);
            localStorage.setItem('auto_clear_data', autoClearData);
            localStorage.setItem('voice_responses', voiceResponses);
            localStorage.setItem('voice_speed', voiceSpeed);
            
            showToast('Settings saved successfully', 'success');
            hideSettingsModal();
        }

        // ==================== UPGRADE MODAL ====================
        function showUpgradeModal() {
            document.getElementById('upgradeModal').classList.add('active');
            toggleUserMenu();
        }

        function hideUpgradeModal() {
            document.getElementById('upgradeModal').classList.remove('active');
        }

        function upgradeToPro() {
            // In a real app, this would redirect to payment
            showToast('Redirecting to payment...', 'info');
            
            // Simulate successful upgrade
            setTimeout(() => {
                if (currentUser) {
                    currentUser.plan = 'pro';
                    localStorage.setItem('cyanix_user', JSON.stringify(currentUser));
                    showToast('Successfully upgraded to Pro!', 'success');
                    hideUpgradeModal();
                }
            }, 1500);
        }

        function upgradeToTeam() {
            showToast('Please contact sales@cyanix.ai for team plans', 'info');
        }

        // ==================== CHAT INTERFACE ====================
        function showChatInterface() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('verificationContainer').classList.remove('active');
            document.getElementById('chatContainer').classList.add('active');
            
            // Update user info
            if (currentUser) {
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('userEmail').textContent = currentUser.email;
                document.getElementById('userAvatar').textContent = currentUser.avatar;
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainChat = document.getElementById('mainChat');
            
            isSidebarOpen = !isSidebarOpen;
            
            if (isSidebarOpen) {
                sidebar.classList.add('active');
                mainChat.classList.add('sidebar-active');
            } else {
                sidebar.classList.remove('active');
                mainChat.classList.remove('sidebar-active');
            }
        }

        function toggleUserMenu() {
            const userMenu = document.getElementById('userMenu');
            userMenuOpen = !userMenuOpen;
            
            if (userMenuOpen) {
                userMenu.classList.add('active');
                // Close menu when clicking outside
                setTimeout(() => {
                    document.addEventListener('click', closeUserMenuOnClickOutside);
                }, 10);
            } else {
                userMenu.classList.remove('active');
                document.removeEventListener('click', closeUserMenuOnClickOutside);
            }
        }

        function closeUserMenuOnClickOutside(event) {
            const userMenu = document.getElementById('userMenu');
            const userProfile = document.querySelector('.user-profile');
            
            if (!userMenu.contains(event.target) && !userProfile.contains(event.target)) {
                userMenu.classList.remove('active');
                userMenuOpen = false;
                document.removeEventListener('click', closeUserMenuOnClickOutside);
            }
        }

        function newChat() {
            currentChatId = 'chat_' + Date.now();
            document.getElementById('messagesContainer').innerHTML = '';
            document.getElementById('chatTitle').textContent = 'New Chat';
            
            // Show welcome screen
            const welcomeScreen = document.getElementById('welcomeScreen').cloneNode(true);
            welcomeScreen.style.display = 'block';
            document.getElementById('messagesContainer').appendChild(welcomeScreen);
            
            // Add to conversations
            const conversation = {
                id: currentChatId,
                title: 'New Chat',
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                messages: []
            };
            
            conversations.unshift(conversation);
            updateConversationList();
            
            if (isSidebarOpen) toggleSidebar();
        }

        function loadConversations() {
            // Load from localStorage
            const savedConversations = localStorage.getItem(`cyanix_conversations_${currentUser?.id}`);
            if (savedConversations) {
                conversations = JSON.parse(savedConversations);
                updateConversationList();
            } else {
                // Create demo conversations for new users
                conversations = [
                    {
                        id: 'chat_1',
                        title: 'Python Programming Help',
                        createdAt: new Date(Date.now() - 3600000).toISOString(),
                        updatedAt: new Date(Date.now() - 3600000).toISOString(),
                        messages: []
                    },
                    {
                        id: 'chat_2',
                        title: 'Business Idea Brainstorming',
                        createdAt: new Date(Date.now() - 86400000).toISOString(),
                        updatedAt: new Date(Date.now() - 86400000).toISOString(),
                        messages: []
                    }
                ];
                updateConversationList();
            }
        }

        function updateConversationList() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            const weekAgo = new Date(today);
            weekAgo.setDate(weekAgo.getDate() - 7);
            
            const todayConvos = conversations.filter(c => new Date(c.updatedAt) >= today);
            const yesterdayConvos = conversations.filter(c => 
                new Date(c.updatedAt) >= yesterday && new Date(c.updatedAt) < today
            );
            const weekConvos = conversations.filter(c => 
                new Date(c.updatedAt) >= weekAgo && new Date(c.updatedAt) < yesterday
            );
            
            updateConversationSection('todayConversations', todayConvos);
            updateConversationSection('yesterdayConversations', yesterdayConvos);
            updateConversationSection('weekConversations', weekConvos);
        }

        function updateConversationSection(sectionId, convos) {
            const section = document.getElementById(sectionId);
            section.innerHTML = '';
            
            convos.forEach(convo => {
                const li = document.createElement('li');
                li.className = 'conversation-item';
                if (convo.id === currentChatId) li.classList.add('active');
                
                li.innerHTML = `
                    <i class="fas fa-comment conversation-icon"></i>
                    <span class="conversation-text">${convo.title}</span>
                `;
                
                li.onclick = () => loadChat(convo.id);
                section.appendChild(li);
            });
        }

        function loadChat(chatId) {
            currentChatId = chatId;
            const conversation = conversations.find(c => c.id === chatId);
            
            if (conversation) {
                document.getElementById('chatTitle').textContent = conversation.title;
                document.getElementById('messagesContainer').innerHTML = '';
                
                // Load messages
                conversation.messages?.forEach(msg => {
                    addMessageToUI(msg.content, msg.sender, msg.timestamp);
                });
                
                // If no messages, show welcome screen
                if (!conversation.messages || conversation.messages.length === 0) {
                    const welcomeScreen = document.getElementById('welcomeScreen').cloneNode(true);
                    welcomeScreen.style.display = 'block';
                    document.getElementById('messagesContainer').appendChild(welcomeScreen);
                }
                
                updateConversationList();
                if (isSidebarOpen) toggleSidebar();
            }
        }

        // ==================== MESSAGING ====================
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Hide welcome screen
            document.getElementById('welcomeScreen')?.remove();
            
            // Add user message
            addMessageToUI(message, 'user');
            
            // Clear input
            input.value = '';
            autoResizeInput(input);
            
            // Show typing indicator
            showTypingIndicator();
            
            // Save to conversation
            const conversation = conversations.find(c => c.id === currentChatId);
            if (conversation) {
                if (!conversation.messages) conversation.messages = [];
                
                conversation.messages.push({
                    id: 'msg_' + Date.now(),
                    content: message,
                    sender: 'user',
                    timestamp: new Date().toISOString()
                });
                
                // Update conversation title if first message
                if (conversation.messages.length === 1) {
                    conversation.title = message.substring(0, 30) + (message.length > 30 ? '...' : '');
                    document.getElementById('chatTitle').textContent = conversation.title;
                }
                
                conversation.updatedAt = new Date().toISOString();
                saveConversations();
            }
            
            // Simulate AI response
            setTimeout(() => {
                hideTypingIndicator();
                const aiResponse = generateAIResponse(message);
                addMessageToUI(aiResponse, 'assistant');
                
                // Save AI response
                if (conversation) {
                    conversation.messages.push({
                        id: 'msg_' + Date.now(),
                        content: aiResponse,
                        sender: 'assistant',
                        timestamp: new Date().toISOString()
                    });
                    conversation.updatedAt = new Date().toISOString();
                    saveConversations();
                }
            }, 1000 + Math.random() * 1000);
        }

        function addMessageToUI(content, sender, timestamp = null) {
            const container = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-avatar ${sender}">
                        ${sender === 'user' ? (currentUser?.avatar || 'U') : 'AI'}
                    </div>
                    <div class="message-sender">
                        ${sender === 'user' ? (currentUser?.name || 'You') : 'Cyanix AI'}
                    </div>
                    <div class="message-time">
                        ${timestamp ? formatTime(timestamp) : formatTime(new Date().toISOString())}
                    </div>
                </div>
                <div class="message-content">${formatMessage(content)}</div>
                <div class="message-actions">
                    <button class="message-action" onclick="copyMessage(this)">
                        <i class="fas fa-copy"></i>
                    </button>
                    <button class="message-action" onclick="regenerateMessage(this)">
                        <i class="fas fa-redo"></i>
                    </button>
                    <button class="message-action" onclick="likeMessage(this)">
                        <i class="far fa-thumbs-up"></i>
                    </button>
                </div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function showTypingIndicator() {
            const container = document.getElementById('messagesContainer');
            const typingDiv = document.createElement('div');
            
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="typing-avatar">AI</div>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            
            container.appendChild(typingDiv);
            container.scrollTop = container.scrollHeight;
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) indicator.remove();
        }

        function generateAIResponse(userMessage) {
            // Simulate different AI responses based on message content
            const responses = {
                greetings: [
                    "Hello! I'm Cyanix AI, your intelligent assistant. How can I help you today?",
                    "Hi there! I'm here to help with anything you need. What's on your mind?",
                    "Greetings! Ready to dive into some interesting topics together?"
                ],
                help: [
                    "I can help you with a wide range of tasks including:\nâ€¢ Writing and editing\nâ€¢ Code generation and debugging\nâ€¢ Research and analysis\nâ€¢ Creative brainstorming\nâ€¢ Learning explanations\nâ€¢ Problem solving",
                    "I'm designed to assist with various tasks. You can ask me to:\nâ€¢ Explain complex concepts\nâ€¢ Generate creative ideas\nâ€¢ Write code in multiple languages\nâ€¢ Analyze data or text\nâ€¢ Help with planning and organization"
                ],
                coding: [
                    "I can help with coding in Python, JavaScript, Java, C++, and many other languages. What specific coding task do you need assistance with?",
                    "As a coding assistant, I can:\nâ€¢ Write functions and algorithms\nâ€¢ Debug code\nâ€¢ Explain programming concepts\nâ€¢ Suggest best practices\nâ€¢ Convert code between languages"
                ],
                creative: [
                    "Let's get creative! I can help with:\nâ€¢ Story writing\nâ€¢ Marketing copy\nâ€¢ Business names\nâ€¢ Creative concepts\nâ€¢ Design ideas\nâ€¢ Artistic inspiration",
                    "For creative tasks, I can assist with brainstorming, generating ideas, writing content, and providing creative feedback."
                ],
                default: [
                    "I understand you're asking about: \"" + userMessage + "\"\n\nLet me provide you with a comprehensive response...",
                    "That's an interesting question. Based on my analysis, here's what I can tell you...",
                    "I've processed your query and here's my detailed response..."
                ]
            };

            // Categorize the user message
            let category = 'default';
            const lowerMessage = userMessage.toLowerCase();

            if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                category = 'greetings';
            } else if (lowerMessage.includes('help') || lowerMessage.includes('what can you do')) {
                category = 'help';
            } else if (lowerMessage.includes('code') || lowerMessage.includes('program') || lowerMessage.includes('python') || lowerMessage.includes('javascript')) {
                category = 'coding';
            } else if (lowerMessage.includes('creative') || lowerMessage.includes('write') || lowerMessage.includes('story') || lowerMessage.includes('idea')) {
                category = 'creative';
            }

            const categoryResponses = responses[category];
            const response = categoryResponses[Math.floor(Math.random() * categoryResponses.length)];

            // Add some detail based on the message
            if (category === 'default') {
                return response + "\n\n" + generateDetailedResponse(userMessage);
            }

            return response;
        }

        function generateDetailedResponse(message) {
            const topics = [
                "This is an important topic because it affects many areas of modern technology and society.",
                "Let me break this down into key points for better understanding.",
                "Here's a structured approach to thinking about this:",
                "Based on current best practices and research, here's what you should know:",
                "I've analyzed this from multiple perspectives to give you a comprehensive answer."
            ];

            const details = [
                "First, consider the fundamental principles involved.",
                "Next, look at practical applications and real-world examples.",
                "It's also important to understand the limitations and challenges.",
                "Recent developments have significantly impacted this area.",
                "For implementation, here are some actionable steps you can take."
            ];

            const conclusion = [
                "I hope this provides a clear understanding. Would you like me to elaborate on any specific aspect?",
                "This should give you a solid foundation. Feel free to ask follow-up questions.",
                "Let me know if you need more detailed information on any of these points.",
                "Is there anything specific about this topic you'd like to explore further?"
            ];

            return topics[Math.floor(Math.random() * topics.length)] + "\n\n" +
                   details[Math.floor(Math.random() * details.length)] + " " +
                   details[Math.floor(Math.random() * details.length)] + "\n\n" +
                   conclusion[Math.floor(Math.random() * conclusion.length)];
        }

        function useExample(type) {
            const examples = {
                brainstorm: "Help me brainstorm creative project ideas for a tech startup that combines AI with environmental sustainability.",
                explain: "Explain quantum computing in simple terms. How does it differ from classical computing, and what are its potential applications?",
                code: "Write a Python function to sort a list using quicksort algorithm. Include comments explaining each step and provide example usage.",
                analyze: "Analyze the pros and cons of renewable energy sources (solar, wind, hydro) compared to fossil fuels. Consider factors like cost, efficiency, environmental impact, and scalability."
            };

            document.getElementById('chatInput').value = examples[type];
            autoResizeInput(document.getElementById('chatInput'));
        }

        // ==================== UI UTILITIES ====================
        function autoResizeInput(textarea) {
            textarea.style.height = 'auto';
            const newHeight = Math.min(textarea.scrollHeight, 200);
            textarea.style.height = newHeight + 'px';
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
     